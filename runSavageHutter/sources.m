%===============================================================================%                               SOURCE TERM S%===============================================================================function source = sources(uv, xv, cosTheta, sinTheta, mu)  global g;  % A smooth 'sign' function u/|u| --- gives granular friction a smooth  % 'viscous' regime at very low speeds to avoid numerical issues.  % There are better but more complex ways of doing this...  sgnu = tanh(1000.0*uv(:,2)./uv(:,1));  source = [0*uv(:,1) ...            g.*sinTheta.*uv(:,1) - sgnu.*mu.*g.*uv(:,1).*cosTheta];end